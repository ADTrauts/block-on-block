// ============================================================================
// PRICING CONFIGURATION MODELS
// ============================================================================

// Pricing configuration for subscription tiers
model PricingConfig {
  id              String   @id @default(uuid())
  tier            String   // 'free', 'pro', 'business_basic', 'business_advanced', 'enterprise'
  billingCycle    String   // 'monthly', 'yearly'
  
  // Pricing
  basePrice       Float
  perEmployeePrice Float?  // For business tiers
  includedEmployees Int?   // For business tiers
  
  // AI Query Packs (optional - for future implementation)
  queryPackSmall  Float?   // 500 queries
  queryPackMedium Float?   // 2,500 queries
  queryPackLarge  Float?   // 5,000 queries
  queryPackEnterprise Float? // 10,000 queries
  
  // Base AI Allowances (optional - for future implementation)
  baseAIAllowance Int?    // Queries included per month
  
  // Stripe Integration
  stripePriceId   String?  // Stripe price ID
  
  // Status
  isActive        Boolean  @default(true)
  effectiveDate   DateTime // When this pricing takes effect
  endDate         DateTime? // When this pricing expires (for future changes)
  
  // Metadata
  createdBy       String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  // Relationships
  createdByUser   User     @relation("PricingConfigCreatedBy", fields: [createdBy], references: [id], onDelete: Cascade)
  priceChanges    PriceChange[]
  
  @@unique([tier, billingCycle, effectiveDate])
  @@index([tier, isActive])
  @@index([effectiveDate])
  @@index([tier, billingCycle])
  @@map("pricing_configs")
}

// Price change history and audit trail
model PriceChange {
  id              String   @id @default(uuid())
  pricingConfigId String
  changeType      String   // 'base_price', 'per_employee', 'query_pack', etc.
  oldValue        Float
  newValue        Float
  reason          String?
  notificationSent Boolean @default(false)
  notificationSentAt DateTime?
  
  createdBy       String
  createdAt       DateTime @default(now())
  
  // Relationships
  pricingConfig   PricingConfig @relation(fields: [pricingConfigId], references: [id], onDelete: Cascade)
  createdByUser   User     @relation("PriceChangeCreatedBy", fields: [createdBy], references: [id], onDelete: Cascade)
  
  @@index([pricingConfigId])
  @@index([createdAt])
  @@index([changeType])
  @@map("price_changes")
}

